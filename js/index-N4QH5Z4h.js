import{w as e,i as t,a as n,c as s,j as a,b as o,R as r}from"./.pnpm-C7rwdCBP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const l=e=>localStorage.getItem(e),c=(e,t)=>localStorage.setItem(e,t),{getDayDetail:i}=n;dayjs.extend(e),dayjs.extend(t);const d=dayjs,u=()=>new Date,m=e=>`${Math.floor(e/3600)} 小时 ${Math.floor(e%3600/60)} 分 ${e%60} 秒`,f=()=>{const e=dayjs(),t=e.startOf("week"),n=e.endOf("week"),s=[];let a=t;for(;a.isSameOrBefore(n);)s.push(a.format("YYYY-MM-DD")),a=a.add(1,"day");return s},h=({addToast:e,openModal:t,setExportData:n})=>{const[o,r]=React.useState("morning"),[h,x]=React.useState(null),[g,b]=React.useState(null),[j,p]=React.useState([]),[R,y]=React.useState(null),[N,M]=React.useState(null),[k,S]=React.useState(null),D=React.useCallback((()=>{const e=l("weekData");try{if(e)return n&&n(e),JSON.parse(e)}catch(t){return[]}return[]}),[n]),C=React.useCallback((e=>{const t=String(e),n=d(e).format("YYYY-MM-DD");p((e=>{const s=[...e],a=s.findIndex((e=>e.date===n));-1!==a?"morning"===o?s[a].morning=t:s[a].night=t:s.push({date:n,morning:"morning"===o?t:null,night:"night"===o?t:null});const r=JSON.stringify(s);return c("weekData",r),s}))}),[o]),v=React.useCallback((()=>{const e=u();c(`${o}`,String(e)),"morning"===o?(x(d(e).format("MM-DD HH-mm")),r("night")):b(d(e).format("MM-DD HH-mm")),C(e)}),[o,C]);React.useEffect((()=>{const e=l("morning"),t=l("night"),n=D();if(n.length>0&&p(n),e){const t=d(e);t.format("dd")===d().format("dd")&&r("night"),x(t.format("MM-DD HH-mm"))}t&&b(d(t).format("MM-DD HH-mm"))}),[D]),React.useEffect((()=>{let e=0;const t=d().week(),n=(e,t)=>t.diff(e,"second");for(let s=0;s<j.length;s++){const a=j[s],{date:o,morning:r,night:l}=a;if(!r||!l||d(o).week()!==t)continue;const c=n(d(r),d(l));c>0&&(e+=c)}e>0&&(M(m(e)),S(m((()=>{const e=f();let t=0;return e.forEach((e=>{i(e).work&&t++})),11.5*t*3600})()-e)))}),[j]),React.useEffect((()=>{let e;if(h&&g){const t=d(l("morning")),n=()=>{const e=u(),n=d(e).diff(t,"second"),s=Math.floor(n/3600),a=Math.floor((n-3600*s)/60);y(`${s} 小时 ${a} 分 ${n%60} 秒`),c("night",String(e)),C(e)};n(),e=setInterval(n,1e3)}return()=>{clearInterval(e)}}),[h,g,C]);const w=React.useCallback((()=>{const t=D();s(JSON.stringify(t)),e({text:"复制成功"})}),[D,e]),O=React.useCallback((()=>{const e=D();n(JSON.stringify(e)),t()}),[D,t,n]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{className:"morning"===o?"btn mr-6 btn-outline":"btn mr-6 btn-accent",onClick:v,children:a.jsx("h2",{className:"text-lg font-bold",children:"morning"===o?"早上打卡":"晚上打卡"})}),a.jsx("button",{className:"mr-6 btn btn-outline btn-info",onClick:w,children:a.jsx("h2",{className:"text-lg font-bold",children:"导出数据"})}),a.jsx("button",{className:"btn btn-outline btn-secondary",onClick:O,children:a.jsx("h2",{className:"text-lg font-bold",children:"导入数据"})})]}),a.jsx("div",{className:"card w-90 shadow-xl bg-teal-100 mt-6",children:a.jsxs("div",{className:"card-body p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["上次早上打卡时间: ",h]}),a.jsxs("h2",{className:"text-lg font-semibold",children:["上次晚上打卡时间: ",g]}),a.jsxs("h2",{className:"text-lg font-semibold",children:["今天已经工作时长: ",R]}),a.jsxs("h2",{className:"text-lg font-semibold",children:["本周已经工作时长: ",N]}),a.jsxs("h2",{className:"text-lg font-semibold",children:["本周剩余工作时长: ",k]})]})})]})},x=()=>a.jsx("div",{className:"flex justify-center content-center min-h-screen",style:{mask:"linear-gradient(black, transparent)"},children:a.jsx("span",{className:"loading loading-spinner loading-lg",style:{width:"3rem"}})}),g=({title:e,children:t,isOpen:n,onClose:s})=>{const o=React.useRef(null);return React.useEffect((()=>{n&&(null==o?void 0:o.current)&&(null==o||o.current.showModal());const e=e=>"Escape"===e.key?s():null;return document.body.addEventListener("keydown",e),()=>{document.body.removeEventListener("keydown",e)}}),[s,n,o]),n?ReactDOM.createPortal(a.jsxs("dialog",{id:"my_modal_2",className:"modal",ref:o,children:[a.jsxs("div",{className:"modal-box",children:[a.jsx("h2",{children:e}),a.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick:s,children:"✕"}),t]}),a.jsx("form",{method:"dialog",className:"modal-backdrop",children:a.jsx("button",{})})]}),document.body):null},b=({defaultValue:e,onChange:t})=>{const n=React.useRef(null),[s,o]=React.useState("auto");React.useEffect((()=>{n.current&&(o("auto"),o(n.current.scrollHeight))}),[e]);return a.jsx("textarea",{className:"textarea textarea-bordered w-full mt-4 h-fit",ref:n,placeholder:"Bio",defaultValue:e,onChange:e=>{n.current&&(o("auto"),o(n.current.scrollHeight)),t&&t(e)},style:{height:s}})},j=({text:e,duration:t=2e3,onClose:n})=>(React.useEffect((()=>{const e=setTimeout((()=>{n&&n()}),t);return()=>{clearTimeout(e)}}),[t,n]),ReactDOM.createPortal(a.jsx("div",{className:"toast toast-top toast-center",children:a.jsx("div",{className:"alert alert-success flex",children:e})}),document.body));function p(){const[e,t]=React.useState(!0),{ToastContainer:n,addToast:s}=(()=>{const[e,t]=React.useState([]),n=React.useCallback((({text:e,duration:n=2e3})=>{const s=Date.now();t((t=>[...t,{id:s,text:e,duration:n}])),setTimeout((()=>{t((e=>e.filter((e=>e.id!==s))))}),n)}),[]),s=React.useCallback((e=>{t((t=>t.filter((t=>t.id!==e))))}),[]);return{toasts:e,addToast:n,removeToast:s,ToastContainer:()=>a.jsx(a.Fragment,{children:e.map((e=>a.jsx(j,{text:e.text,duration:e.duration,onClose:()=>s(e.id)},e.id)))})}})(),{isOpen:o,openModal:r,closeModal:l}=(()=>{const[e,t]=React.useState(!1);return{isOpen:e,openModal:()=>t(!0),closeModal:()=>t(!1)}})();React.useEffect((()=>{setTimeout((()=>{t(!1)}),1e3)}),[]);const[c,i]=React.useState("");return a.jsxs("div",{className:"flex justify-center items-center h-screen",children:[e?a.jsx(x,{}):a.jsx("div",{className:"flex flex-col items-center",children:a.jsx(h,{addToast:s,openModal:r,setExportData:i})}),a.jsx(n,{}),a.jsx(g,{isOpen:o,onClose:l,title:"导入数据",children:a.jsx(b,{defaultValue:c,onChange:e=>{}})})]})}const R=o([{path:"/",element:a.jsx(p,{})},{path:"*",element:a.jsx(p,{})}]),y=document.getElementById("root");if(y){ReactDOM.createRoot(y).render(a.jsx(React.StrictMode,{children:a.jsx(r,{router:R})}))}
