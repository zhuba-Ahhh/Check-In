import{j as e,w as t,c as n,R as r}from"./.pnpm-BRjxTSZz.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const s=()=>e.jsx("div",{className:"flex justify-center content-center min-h-screen",style:{mask:"linear-gradient(black, transparent)"},children:e.jsx("span",{className:"loading loading-spinner loading-lg",style:{width:"3rem"}})}),c=e=>localStorage.getItem(e),o=(e,t)=>localStorage.setItem(e,t);dayjs.extend(t);const a=dayjs,i=()=>new Date,l=()=>{const[t,n]=React.useState("morning"),[r,s]=React.useState(null),[l,d]=React.useState(null),[m,f]=React.useState([]),[u,h]=React.useState(null),[g,j]=React.useState(null),x=React.useCallback((e=>{const n=String(e),r=a(e).format("YYYY-MM-DD");f((e=>{const s=[...e],c=s.findIndex((e=>e.date===r));return-1!==c?"morning"===t?s[c].morning=n:s[c].night=n:s.push({date:r,morning:"morning"===t?n:null,night:"night"===t?n:null}),o("weekData",JSON.stringify(s)),s}))}),[t]),p=React.useCallback((()=>{const e=i();o(`${t}`,String(e)),"morning"===t?(s(a(e).format("MM-DD HH-mm")),n("night")):d(a(e).format("MM-DD HH-mm")),x(e)}),[t,x]);return React.useEffect((()=>{const e=c("morning"),t=c("night"),r=c("weekData");try{r&&f(JSON.parse(r))}catch(o){}if(e){const t=a(e);t.format("dd")===a().format("dd")&&n("night"),s(t.format("MM-DD HH-mm"))}t&&d(a(t).format("MM-DD HH-mm"))}),[]),React.useEffect((()=>{let e=0;const t=a().week(),n=(e,t)=>t.diff(e,"second");for(let r=0;r<m.length;r++){const s=m[r],{date:c,morning:o,night:i}=s;if(!o||!i||a(c).week()!==t)continue;const l=n(a(o),a(i));l>0&&(e+=l)}if(e>0){const t=Math.floor(e/3600),n=Math.floor(e%3600/60);j(`${t} 小时 ${n} 分 ${e%60} 秒`)}}),[m]),React.useEffect((()=>{let e;if(r&&l){const t=a(c("morning")),n=()=>{const e=i(),n=a(e).diff(t,"second"),r=Math.floor(n/3600),s=Math.floor((n-3600*r)/60);h(`${r} 小时 ${s} 分 ${n%60} 秒`),o("night",String(e)),x(e)};n(),e=setInterval(n,1e3)}return()=>{clearInterval(e)}}),[r,l,x]),e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"morning"===t?"btn btn-outline":"btn btn-accent",onClick:p,children:e.jsx("h2",{children:"morning"===t?"早上打卡":"晚上打卡"})}),e.jsx("div",{className:"card w-96 shadow-xl bg-teal-100 mt-6",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h2",{children:["上次早上打卡时间: ",r]}),e.jsxs("h2",{children:["上次晚上打卡时间: ",l]}),e.jsxs("h2",{children:["今天已经工作时长: ",u]}),e.jsxs("h2",{children:["本周已经工作时长: ",g]})]})})]})};function d(){const[t,n]=React.useState(!0);return React.useEffect((()=>{setTimeout((()=>{n(!1)}),1e3)}),[]),e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:t?e.jsx(s,{}):e.jsx("div",{className:"flex justify-center flex-col items-center",children:e.jsx(l,{})})})}const m=n([{path:"/",element:e.jsx(d,{})},{path:"*",element:e.jsx(d,{})}]),f=document.getElementById("root");if(f){ReactDOM.createRoot(f).render(e.jsx(React.StrictMode,{children:e.jsx(r,{router:m})}))}
