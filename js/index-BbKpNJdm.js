import{j as e,w as t,i as n,a as s,c as r,b as a,R as o}from"./.pnpm-C7rwdCBP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const c=()=>e.jsx("div",{className:"flex justify-center content-center min-h-screen",style:{mask:"linear-gradient(black, transparent)"},children:e.jsx("span",{className:"loading loading-spinner loading-lg",style:{width:"3rem"}})}),l=e=>localStorage.getItem(e),i=(e,t)=>localStorage.setItem(e,t),{getDayDetail:d}=s;dayjs.extend(t),dayjs.extend(n);const m=dayjs,f=()=>new Date,u=e=>`${Math.floor(e/3600)} 小时 ${Math.floor(e%3600/60)} 分 ${e%60} 秒`,g=()=>{const e=dayjs(),t=e.startOf("week"),n=e.endOf("week"),s=[];let r=t;for(;r.isSameOrBefore(n);)s.push(r.format("YYYY-MM-DD")),r=r.add(1,"day");return s},h=()=>{const[t,n]=React.useState("morning"),[s,a]=React.useState(null),[o,c]=React.useState(null),[h,x]=React.useState([]),[j,b]=React.useState(null),[y,p]=React.useState(null),[N,R]=React.useState(null),M=React.useCallback((()=>{const e=l("weekData");try{if(e)return JSON.parse(e)}catch(t){return[]}return[]}),[]),S=React.useCallback((e=>{const n=String(e),s=m(e).format("YYYY-MM-DD");x((e=>{const r=[...e],a=r.findIndex((e=>e.date===s));return-1!==a?"morning"===t?r[a].morning=n:r[a].night=n:r.push({date:s,morning:"morning"===t?n:null,night:"night"===t?n:null}),i("weekData",JSON.stringify(r)),r}))}),[t]),D=React.useCallback((()=>{const e=f();i(`${t}`,String(e)),"morning"===t?(a(m(e).format("MM-DD HH-mm")),n("night")):c(m(e).format("MM-DD HH-mm")),S(e)}),[t,S]);React.useEffect((()=>{const e=l("morning"),t=l("night"),s=M();if(s.length>0&&x(s),e){const t=m(e);t.format("dd")===m().format("dd")&&n("night"),a(t.format("MM-DD HH-mm"))}t&&c(m(t).format("MM-DD HH-mm"))}),[M]),React.useEffect((()=>{let e=0;const t=m().week(),n=(e,t)=>t.diff(e,"second");for(let s=0;s<h.length;s++){const r=h[s],{date:a,morning:o,night:c}=r;if(!o||!c||m(a).week()!==t)continue;const l=n(m(o),m(c));l>0&&(e+=l)}e>0&&(p(u(e)),R(u((()=>{const e=g();let t=0;return e.forEach((e=>{d(e).work&&t++})),11.5*t*3600})()-e)))}),[h]),React.useEffect((()=>{let e;if(s&&o){const t=m(l("morning")),n=()=>{const e=f(),n=m(e).diff(t,"second"),s=Math.floor(n/3600),r=Math.floor((n-3600*s)/60);b(`${s} 小时 ${r} 分 ${n%60} 秒`),i("night",String(e)),S(e)};n(),e=setInterval(n,1e3)}return()=>{clearInterval(e)}}),[s,o,S]);const k=React.useCallback((()=>{const e=M();r(JSON.stringify(e))}),[M]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("button",{className:"morning"===t?"btn mr-6 btn-outline":"btn mr-6 btn-accent",onClick:D,children:e.jsx("h2",{className:"text-lg font-bold",children:"morning"===t?"早上打卡":"晚上打卡"})}),e.jsx("button",{className:"btn btn-outline btn-info",onClick:k,children:e.jsx("h2",{className:"text-lg font-bold",children:"导出数据"})})]}),e.jsx("div",{className:"card w-90 shadow-xl bg-teal-100 mt-6",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["上次早上打卡时间: ",s]}),e.jsxs("h2",{className:"text-lg font-semibold",children:["上次晚上打卡时间: ",o]}),e.jsxs("h2",{className:"text-lg font-semibold",children:["今天已经工作时长: ",j]}),e.jsxs("h2",{className:"text-lg font-semibold",children:["本周已经工作时长: ",y]}),e.jsxs("h2",{className:"text-lg font-semibold",children:["本周剩余工作时长: ",N]})]})})]})};function x(){const[t,n]=React.useState(!0);return React.useEffect((()=>{setTimeout((()=>{n(!1)}),1e3)}),[]),e.jsx("div",{className:"flex justify-center items-center h-screen",children:t?e.jsx(c,{}):e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(h,{})})})}const j=a([{path:"/",element:e.jsx(x,{})},{path:"*",element:e.jsx(x,{})}]),b=document.getElementById("root");if(b){ReactDOM.createRoot(b).render(e.jsx(React.StrictMode,{children:e.jsx(o,{router:j})}))}
